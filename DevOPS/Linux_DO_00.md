## Part 1: Установка ОС

- Установлена Ubuntu 24.04.2 LTS
- Проверяем версию виртуальной машины / операционной системы:
  ```bash
  cat /etc/issue
  ```
  ![Проверка версии](screens/1.png)  
  *Рис. 1: Вывод терминала*

## Part 2: Создание пользователя

- Создаем пользователя с именем **user2**:
  ```bash
  sudo adduser user2
  ```
- Добавляем в группу с помощью **append**:
- [a, --append: ](https://www.opennet.ru/man.shtml?topic=usermod&category=8&russian=0)
    *Добавить пользователя в дополнительную группу(ы). Использовать только вместе с параметром -G*

  ```bash
  sudo usermod -aG adm user2
  ```
- Проверяем, появился ли наш новый профиль: 
   ```bash
    cat /etc/passwd
   ```
  ![Добавление user2](screens/2.png)  
  *Рис. 2: Создание пользователя от А до Я*

## Part 3: Настройка сети ОС

- Задаем название машины вида user-1:
  ```bash
  sudo hostnamectl set-hostname user-1
  ```
- Далее задаем часовой пояс (Новосибирск) и проверяем правильность установки:
  ```bash
  timedatectl
  ```
- Выводим названия сетевых интерфейсов и получаем ip адрес устройства, на котором работаем:
  ```bash
  ip a
  ```
- DHCP — протокол прикладного уровня модели TCP/IP, служит для назначения IP-адреса клиенту. Это следует из его названия — Dynamic Host Configuration Protocol: **Discovery** + **Offer** + **Request** + **Acknowledgement (ACK)**

  ![Установка интерфейса](screens/3.1.png)  
  *Рис. 3.1: Настройка и проверка user-1*
- Определяем внешний и внутренний IP шлюза -
    Внутренний IP (шлюз по умолчанию):
  ```bash
  ip route | grep default
  ```
  Внешний IP (публичный адрес):
  ```bash
  curl ifconfig.me
  ```
- Пингуем удалённые хосты:
  ```bash
  ping -c 4 youtube.com
  ```
  ![Настраиваем интерфейс](screens/3.2.png)  
  *Рис. 3.2: Проверка работоспособности user-1*

## Part 4: Обновление ОС

- Проверяем обновления для ubuntu:
  ```bash
  sudo apt upgrade
  ```
- Видим что есть 1 необновленный пакет, обновим его.

  ![Проверка обновлений](screens/4.1.png)  
  *Рис. 4.1: Наличие обновлений*

- Смотрим какой пакет не обновлен, и обновляем его:
  ```bash
  sudo apt update
  sudo apt install ubuntu-drivers-common
  ```

  ![Обновление](screens/4.2.png)  
  *Рис. 4.2: Обновление пакета*

- Окончательно прогоняем на проверку новых пакетов:
  ```bash
  sudo apt upgrade
  ```

  ![Еще одна проверка](screens/4.3.png)  
  *Рис. 4.3: Проверка обновлений*

## Part 5: Использование команды sudo

- Sudo - **Substitute User and do**, дословно «подменить пользователя и выполнить — программа для системного администрирования UNIX-систем
- Меняем hostname от имени нового пользователя:
  ```bash
  su - user2  # Переключаемся на нового пользователя
  sudo hostnamectl set-hostname user-2
  exit
  ```
- Проверяем имя пользователя:
  ```bash
  hostname
  ```
  ![Проверка версии](screens/5.png)  
  *Рис. 5: Смена пользователя*


  ## Part 6: Установка и настройка службы времени

- Устанавливаем и настраиваем службу автоматической синхронизации времени:
  ```bash
  sudo system start chrony
  ```

- Проверяем часовой пояс (Новосибирск):
  ```bash
  timedatectl
  ```

- Проверка синхронизации времени:
  ```bash
  timedatectl show 
  ```
  ![Синхронизация времени](screens/6.png)  
  *Рис. 6: Служба синхронизирована (NTPSynchronized=yes)*

## Part 7: Установка и использование текстовых редакторов

- Устанавливаем текстовые редакторы VIM, NANO и JOE:
  ```bash
  sudo apt install vim nano joe
  ```
  ![Установка](screens/7.1.png)  
  *Рис. 7.1: Устанавливаем библиотки*

- Создаем по файлу test_vim.txt, test_nano.txt, test_joe.txt с никнеймом внутри:

  ![VIM файл](screens/7.2.png)  
  *Рис. 7.2: Файл test_vim.txt перед выходом*

  ![NANO файл](screens/7.3.png)  
  *Рис. 7.3: Файл test_nano.txt перед выходом*

  ![JOE файл](screens/7.4.png)  
  *Рис. 7.4: Файл test_joe.txt перед выходом*

- Выход с сохранением:
  - VIM: `:wq`
  - NANO: `Ctrl+O`, затем `Enter`, затем `Ctrl+X`
  - JOE: `Ctrl` + `K` + `X`

  ![VIM без сохранения](screens/7.5.png)  
  *Рис. 7.5: Итоговые значения*

- Редактируем файлы, заменяя никнейм на "21 School 21", но **выходим без сохранения**:

  ![VIM без сохранения](screens/7.6.png)  
  *Рис. 7.6: VIM — редактирование без сохранения*

  ![NANO без сохранения](screens/7.7.png)  
  *Рис. 7.7: NANO — редактирование без сохранения*

  ![JOE без сохранения](screens/7.8.png)  
  *Рис. 7.8: JOE — редактирование без сохранения*

- Выход без сохранения:
  - VIM: `:q!`
  - NANO: `Ctrl+X`, затем `N`
  - JOE: `Ctrl` + `K` + `Q` 

- Используем поиск и замену:
  - VIM: `/никнейм`, затем `:%s/никнейм/новое_слово/g`
  - NANO: `Ctrl+W`, затем `Ctrl+\\`, ввести старое и новое слово
  - JOE: `Ctrl+Q`, затем `Ctrl+A`

  ![VIM поиск](screens/7.9.png)  
  *Рис. 7.9: VIM — результат поиска*

  ![VIM замена](screens/7.10.png)  
  *Рис. 7.10: VIM — результат замены*

  ![NANO поиск](screens/7.11.png)  
  *Рис. 7.11: NANO — поиск*

  ![NANO замена](screens/7.12.png)  
  *Рис. 7.12: NANO — замена*

  ![JOE поиск](screens/7.13.png)  
  *Рис. 7.13: JOE — поиск и замена*

  ![JOE поиск](screens/7.14.png)  
  *Рис. 7.14: JOE — поиск и замена*

## Part 8: Установка и базовая настройка сервиса SSHD

- Устанавливаем SSH-сервер:
  ```bash
  sudo apt install openssh-server
  ```

  ![Установка sshd](screens/8.1.png)  
  *Рис. 8.1: Установка sshd*

- Добавляем автозапуск:
  ```bash
  sudo systemctl enable ssh
  ```

- Меняем порт на 2022 в конфигурации:
  ```bash
  sudo nano /etc/ssh/sshd_config
  # Меняем Port 22 → Port 2022
  ```

  ![Проверка процесса sshd](screens/8.6.png)  
  *Рис. 8.2: Изменение конфигурации*

- Перезапускаем службу:
  ```bash
  sudo systemctl restart ssh
  ```

- Проверяем наличие процесса:
  ```bash
  ps aux | grep sshd
  ```
  ![Проверка процесса sshd](screens/8.5.png)  
  *Рис. 8.3: Проверка процесса sshd*

- Объяснение команды:
  - `ps` — отображает текущие процессы
  - `aux`:
    - `a` — все пользователи
    - `u` — отображение в формате с пользователями
    - `x` — включает фоновые процессы

- Проверяем порт:
  ```bash
  sudo netstat -tan | grep 2022
  ```
  ![Порт 2022](screens/8.7.png)  
  *Рис. 8.4: Подтверждение работы SSH на порту 2022*

- Объяснение ключей `-tan`:
  - `t` — TCP
  - `a` — все соединения и прослушиваемые порты
  - `n` — не выполнять DNS-резолвинг (показ IP, а не имена)

- Объяснение вывода netstat:
  - `tcp` — тип соединения
  - `0 0` — количество переданных и ожидающих данных
  - `0.0.0.0:2022` — локальный IP и порт
  - `0.0.0.0:*` — любое удалённое соединение
  - `LISTEN` — ожидает подключения

  ## Part 9: Установка и использование утилит top, htop

- Устанавливаем утилиты:
  ```bash
  sudo apt install top htop
  ```

  ![Установка top](screens/9.1.png)  
  *Рис. 9.1: Установка top*

- Запускаем `top` и определяем:
  - uptime
  - количество авторизованных пользователей
  - среднюю загрузку системы
  - общее количество процессов
  - загрузку CPU
  - загрузку памяти
  - PID процесса, занимающего больше всего памяти
  - PID процесса, нагружающего CPU

  ![Вывод top](screens/9.2.png)  
  *Рис. 9.2: Информация из утилиты top*

- Запускаем `htop` и делаем:
  - сортировку по PID
  - сортировку по %CPU
  - сортировку по %MEM
  - сортировку по TIME
  - фильтр по `sshd`
  - поиск процесса `syslog`
  - добавляем вывод hostname, clock, uptime через F2 → Display options
 
  ![top](screens/9.3.png)  
  *Рис. 9.3: Отображение top*

  ![show](screens/9.4.png)  
  *Рис. 9.4: Изменение отображения*

  ![htop](screens/9.5.png)  
  *Рис. 9.5: Отображение сортировок*

  ![htop PID](screens/9.6.png)  
  *Рис. 9.6: Сортировка по PID*

  ![htop CPU](screens/9.7.png)  
  *Рис. 9.7: Сортировка по CPU*

  ![htop MEM](screens/9.8.png)  
  *Рис. 9.8: Сортировка по MEM*

  ![htop TIME](screens/9.9.png)  
  *Рис. 9.9: Сортировка по TIME*

  ![htop sshd](screens/9.10.png)  
  *Рис. 9.10: Фильтр по sshd*

  ![htop syslog](screens/9.11.png)  
  *Рис. 9.11: Поиск syslog*

  ![htop доп. конфиг](screens/9.13.png)  
  *Рис. 9.12: Изменение конфигурации hostname, clock и uptime*

  ![htop доп. вывод](screens/9.14.png)  
  *Рис. 9.13: Отображение hostname, clock и uptime*

## Part 10: Использование утилиты fdisk

- Запускаем команду:
  ```bash
  sudo fdisk -l
  ```

  ![fdisk1](screens/10.1.png)  
  *Рис. 10.1: Вывод утилиты fdisk часть 1*

  ![fdisk2](screens/10.2.png)  
  *Рис. 10.2: Вывод утилиты fdisk часть 2*

  ![fdisk3](screens/10.3.png)  
  *Рис. 10.3: Вывод утилиты fdisk часть 3*

  ![fdisk4](screens/10.4.png)  
  *Рис. 10.4: Вывод утилиты fdisk часть 4*

  ![fdisk5](screens/10.5.png)  
  *Рис. 10.5: Вывод утилиты fdisk часть 5*

- Что имеем исходя из вывода:
  - Название диска: `/dev/sda`
  - Размер диска: `111,79 GB`
  - Количество секторов: `234441648`
  - Размер swap: `99G` (ищем swap раздел по типу ID 83)

## Part 11: Использование утилиты df

- Запускаем команду:
  ```bash
  df -h
  ```

  ![df](screens/11.png)  
  *Рис. 11: Вывод команды df*

- Для корневого раздела `/`:
  - Размер: `97 G`
  - Занято: `21 G`
  - Свободно: `72 G`
  - Использовано: `23%`

- Запускаем команду:
  ```bash
  df -Th
  ```

- Для корневого раздела `/`:
  - Размер: `97 G`
  - Занято: `21 G`
  - Свободно: `72 G`
  - Использовано: `23%`
  - Тип файловой системы: `ext4` 

  ## Part 12: Использование утилиты du

- Запускаем команду:
  ```bash
  sudo du -s /home
  ```

- Человекочитаемый вывод:
  ```bash
  sudo du -sh /home /var /var/log
  ```

  ![du общий размер](screens/12.1.png)  
  *Рис. 12.1: Размер указанных директорий*
  

- Размер содержимого в `/var/log` поэлементно:
  ```bash
  sudo du -sh /var/log/*
  ```

  ![du читаемо](screens/12.2.png)  
  *Рис. 12.2: Размер указанных директорий в читаемом формате*

## Part 13: Установка и использование утилиты ncdu

- Устанавливаем ncdu:
  ```bash
  sudo apt install ncdu
  ```

  ![install](screens/13.1.png)  
  *Рис. 13.1: Установка ncdu*

- Просматриваем директории:
  ```bash
  sudo ncdu /home
  ```

  ![ncdu home](screens/13.2.png)  
  *Рис. 13.2: Просмотр /home*
  

  ```bash
  sudo ncdu /var/log
  ```
  ![ncdu varlog](screens/13.3.png)  
  *Рис. 13.3: Просмотр /var/log*

## Part 14: Работа с системными журналами

- Открываем журналы:
  ```bash
  cat /var/log/dmesg
  cat /var/log/syslog
  cat /var/log/auth.log
  ```

  ![jour1](screens/14.1.png)  
  *Рис. 14.1: Открываем журнал /var/log/dmesg*

  ![jour2](screens/14.2.png)  
  *Рис. 14.2: Открываем журнал /var/log/syslog*

  ![jour3](screens/14.3.png)  
  *Рис. 14.3: Открываем журнал /var/log/auth.log*


- Перезапускаем SSH и выводим информацию:
  ```bash
  sudo grep "Accepted password" /var/log/auth.log | tail -1
  sudo systemctl restart ssh
  ```

  ![рестарт ssh](screens/14.4.png)  
  *Рис. 14.2: Последняя успешная авторизация и сообщение о рестарте службы SSHd*

- Данные:
  - Время: `11:27`
  - Пользователь: `user2`
  - Метод входа: `password`

## Part 15: Использование планировщика заданий CRON

- Открываем crontab:
  ```bash
  crontab -e
  ```

  ![cron open](screens/15.1.png)  
  *Рис. 15.1: Открываем crontab для root*

- Добавляем задание:
  ```
  */2 * * * * /usr/bin/uptime >> /home/user2/uptime.log
  ```

  ![cron open](screens/15.2.png)  
  *Рис. 15.2: Открываем crontab и дополняем для user*

  ![cron edit](screens/15.3.png)  
  *Рис. 15.3: Подтверждение изменения конфигурации*

- Смотрим системный статус:
  ```bash
  sudo systemctl status cron
  ```
  ![cron логи](screens/15.4.png)  
  *Рис. 15.4: Статус режима cron*


- Смотрим системный журнал:
  ```bash
  sudo grep CRON /var/log/syslog
  ```

- Список заданий:
  ```bash
  crontab -l
  ```

- Удаляем все задания:
  ```bash
  crontab -r
  crontab -l
  ```
  ![пусто в cron](screens/15.6.png)  
  *Рис. 15.5: Итоговый требуемый вывод*
